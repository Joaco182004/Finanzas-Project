<section>
    <h1 class="tracking-in-expand">Realizar Corrida</h1>
    <div class="formularios" *ngIf="!iniciarCorrida">
        <form class="datos-bono" [formGroup]="val_ini">
            <mat-form-field appearance="fill" class="select" >
                <mat-label>Seleccione la moneda</mat-label>
                <mat-select disableRipple formControlName="mon">
                  <mat-option value="Dólares" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Dólares</mat-option>
                  <mat-option value="Soles" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Soles</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="input" >
                <mat-label>Ingrese el valor del inmueble</mat-label>
                <input formControlName="inm" matInput>
            </mat-form-field>
            <mat-form-field appearance="fill" class="input" >
                <mat-label>Ingrese el % de la cuota inicial
                </mat-label>
                <input type="number" matInput formControlName="cuo_i" >
            </mat-form-field>
            <mat-form-field appearance="fill" class="select"  >
                <mat-label>Seleccione el tipo de tasa</mat-label>
                <mat-select (valueChange)="validarAparicion($event)" disableRipple formControlName="tip_t">
                  <mat-option value="TE" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Tasa Efectiva</mat-option>
                  <mat-option value="TN" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Tasa Nominal</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="select">
                <mat-label>Seleccione el tiempo de la tasa</mat-label>
                <mat-select disableRipple  formControlName="tie_t">
                  <mat-option value="M" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Mensual</mat-option>
                  <mat-option value="B" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Bimestral</mat-option>
                  <mat-option value="T" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Trimestral</mat-option>
                  <mat-option value="S" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Semestral</mat-option>
                  <mat-option value="A" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Anual</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="select" *ngIf="aparicion_tiempo_cap">
                <mat-label>Seleccione la capitalización</mat-label>
                <mat-select disableRipple  formControlName="tie_c" >
                
                  <mat-option value="Diaria" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Diaria</mat-option>
                  <mat-option value="Mensual" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Mensual</mat-option>
                  <mat-option value="Bimestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Bimestral</mat-option>
                  <mat-option value="Trimestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Trimestral</mat-option>
                  <mat-option value="Semestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Semestral</mat-option>
                  <mat-option value="Anual" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Anual</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="input">
                <mat-label>Ingrese el valor la tasa
                </mat-label>
                <input matInput  formControlName="val_t">
            </mat-form-field>
            <mat-form-field appearance="fill" class="select">
                <mat-label>Seleccione la frecuencia de pago</mat-label>
                <mat-select disableRipple  formControlName="frec_p">
                  <mat-option value="Mensual" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Mensual</mat-option>
                  <mat-option value="Bimestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Bimestral</mat-option>
                  <mat-option value="Trimestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Trimestral</mat-option>
                  <mat-option value="Semestral" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Semestral</mat-option>
                  <mat-option value="Anual" style="font-family: 'Montserrat', sans-serif;
                  color: rgb(47, 15, 55);">Anual</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill" class="input" >
                <mat-label>Cantidad de años para pagar
                </mat-label>
                <input matInput formControlName="tie_p" >
            </mat-form-field>
            <button mat-raised-button color="primary" type="button" (click)="pasarDatos()" [disabled]="val_ini.invalid">Validar Corrida</button>
        </form>
        <div class="show-info">
            <div class="info">
                <h4>Tipo de Moneda:</h4> 
                <h5>{{moneda}}</h5>
            </div>
            <mat-divider ></mat-divider>
            <div class="info">
                <h4>Precio del inmueble:</h4>
                <h5>{{simbolo}} {{valor_inmueble}}</h5>
            </div>
            <mat-divider></mat-divider>
            <div class="info">
                <h4>Primera cuota inicial:</h4>
                <h5>{{simbolo}} {{valor_inmueble*cuota_inicial/100}}</h5>
            </div>
            <mat-divider></mat-divider>
            <div class="info">
                <h4>Monto a financiar:</h4>
                <h5>{{simbolo}} {{monto_financiar}}</h5>
            </div >
            <mat-divider></mat-divider>
            <div class="info">
                <h4>Tasa:</h4>
                <h5>{{valor_tasa}}% de {{tipo_tasa}}{{tiempo_tasa}}</h5>
            </div>
            <mat-divider></mat-divider>
            <div class="info" *ngIf="aparicion_tiempo_cap" >
                <h4>Capitalización</h4>
                <h5>{{tiempo_cap}}</h5>
            </div>
            <mat-divider *ngIf="aparicion_tiempo_cap"></mat-divider >
            <div class="info">
                <h4>Tasa Convertida:</h4>
                <h5>{{nueva_tasa.toString().length>=2 ? nueva_tasa.toFixed(7):nueva_tasa }}% de {{ape_tasa}}</h5>
            </div>
           
            
            <mat-divider></mat-divider>
            <div class="info">
                <h4>N° de años:</h4>
                <h5>{{cantidad_anios}}</h5>
            </div>
            <mat-divider></mat-divider>
            <div class="info">
                <h4>Frecuencia de pago:</h4>
                <h5>{{frecuencia_pago}}</h5>
            </div>
            <mat-divider></mat-divider>
            <div class="info">
                <h4>N° de periodos:</h4>
                <h5>{{num_periodos}}</h5>
            </div>
            <mat-divider></mat-divider>
            <button mat-raised-button color="primary" style="margin-top: 2rem;" [disabled]="realizar" (click)="corrida()">Generar Corrida</button>
        </div>
    </div>
    <div *ngIf="iniciarCorrida" class="corrida">
        <div class="datos-completos">
            <button class="back" (click)="reiniciar()">
                <ion-icon class="icon-back" name="arrow-back-circle"></ion-icon>
                <h5>Realizar otra corrida</h5>
            </button>
            <button class="back" (click)="guardarCorrida()">
                <ion-icon class="icon-back" name="save"></ion-icon>
                <h5>Guardar Corrida</h5>
            </button>
        </div>
        <div class="encabezado">
            <div><h4>N°</h4></div><div><h4>{{this.ape_tasa}}</h4></div><div><h4>Plazo Gracia</h4></div><div><h4>Saldo Inicial</h4></div><div><h4>Interes</h4></div><div><h4>Cuota</h4></div> <div><h4>Amortizacion</h4></div><div><h4>Saldo Final</h4></div>         
        </div>
        <div *ngFor="let periodo of saldo_iniciales; let i=index">
            <div class="periodo" *ngIf="i<num_periodos">
                <div>
                    <h5>{{i+1}}</h5>
                </div>
                <div>
                   <h5>{{nueva_tasa.toFixed(7)}}%</h5>
                </div>
                <div>
                    <h5>{{plazo_gracia}}</h5>
                </div>
                <div>
                    <h5>{{simbolo}} {{saldo_iniciales[i].toFixed(2)}}</h5>
                </div>
                <div>
                    <h5>({{simbolo}} {{intereses[i].toFixed(2)}})</h5>
                </div>
                <div>
                    <h5>({{simbolo}} {{cuota.toFixed(2)}})</h5>
                </div>
                <div>
                    <h5>({{simbolo}} {{amortizaciones[i].toFixed(2)}})</h5>
                </div>
                <div>
                    <h5>{{simbolo}} {{saldo_iniciales[i+1].toFixed(2)}}</h5>
                </div>
                    
            </div>

        </div>
    </div>
    <div class="aviso-save" *ngIf="aviso">
        <div class="info">
            <h4>Tipo de Moneda:</h4> 
            <h5>{{moneda}}</h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>Precio del inmueble:</h4>
            <h5>{{simbolo}} {{valor_inmueble}}</h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>Primera cuota inicial:</h4>
            <h5>{{simbolo}} {{valor_inmueble*cuota_inicial/100}}</h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>Monto a financiar:</h4>
            <h5>{{simbolo}} {{monto_financiar}}</h5>
        </div >
        <div class="divider"></div>
        <div class="info">
            <h4>Tasa:</h4>
            <h5>{{valor_tasa}}% de {{tipo_tasa}}{{tiempo_tasa}} <span *ngIf="aparicion_tiempo_cap">con cap. {{tiempo_cap}}</span></h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>Tasa Convertida:</h4>
            <h5>{{nueva_tasa.toFixed(7)}}% de {{ape_tasa}}</h5>
        </div>
        
        <div class="divider"></div>
        <div class="info">
            <h4>N° de años:</h4>
            <h5>{{cantidad_anios}}</h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>Frecuencia de pago:</h4>
            <h5>{{frecuencia_pago}}</h5>
        </div>
        <div class="divider"></div>
        <div class="info">
            <h4>N° de periodos:</h4>
            <h5>{{num_periodos}}</h5>
        </div>
        <button class="btn-done" (click)="aviso=false">Aceptar</button>
    </div>
</section>